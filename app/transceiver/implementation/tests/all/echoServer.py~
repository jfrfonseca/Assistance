import signal, sys
from SimpleWebSocketServer import WebSocket, SimpleWebSocketServer

class SimpleEcho(WebSocket):
    def handleMessage(self):
        if self.data is None:
            self.data = ''
        try:
            self.sendMessage(str(self.data))
        except Exception as n:
            print n
         
    def handleConnected(self):
        print self.address, 'connected'

    def handleClose(self):
        print self.address, 'closed'
      

def close_sig_handler(signal, frame):
    server.close()
    sys.exit()

server = SimpleWebSocketServer('', 23019, SimpleEcho)
signal.signal(signal.SIGINT, close_sig_handler)
server.serveforever()
